<% layout("/layouts/boilerplate") %>

<div class="container-fluid mt-5">
    <div class="row justify-content-center">
        <div class="col-xl-5 col-lg-5 col-md-6 col-sm-8 border rounded p-4 shadow-sm bg-light">
            <h1 class="text-center mb-4">Reset Password</h1>
            <form id="resetPasswordForm" action="/reset-password/<%= token %>" method="POST" class="needs-validation" novalidate>
                <div class="mb-3">
                    <label for="password" class="form-label">New Password</label>
                    <input name="password" id="password" minlength="8"
                        maxlength="60" pattern="^(?=.*[a-zA-Z])(?=.*[0-9]).{8,60}$" type="password" placeholder="Enter your new password"
                        class="form-control" required>
                    <div class="valid-feedback">Looks Good!</div>
                    <div class="invalid-feedback">The password must be at least 8 characters long and include at least one letter and one digit!</div>
                </div>

                <div class="mb-3">
                    <label for="confirmPassword" class="form-label">Confirm New Password</label>
                    <input name="confirmPassword" id="confirmPassword" minlength="8"
                        maxlength="60" pattern="^(?=.*[a-zA-Z])(?=.*[0-9]).{8,60}$" type="password" placeholder="Confirm your new password"
                        class="form-control" required>
                    <div class="valid-feedback">Looks Good!</div>
                    <div class="invalid-feedback">The password must be at least 8 characters long and include at least one letter and one digit!</div>
                </div>

                <div class="text-center">
                    <button id="resetpassBtn" class="btn btn-primary w-100" type="submit">Reset Password</button>
                </div>
            </form>
        </div>
    </div>
</div>

<script>
    const resetPasswordForm = document.getElementById('resetPasswordForm');
    const resetpassBtn = document.getElementById('resetpassBtn');
    
    resetPasswordForm.addEventListener('submit', function (event) {
         // Check if the form is valid
         if (!resetPasswordForm.checkValidity()) {
             event.preventDefault(); // Prevent form submission if invalid
             event.stopPropagation(); // Stop further event propagation
         } else {
            resetpassBtn.disabled = true; // Disable the button
            resetpassBtn.textContent = 'Processing...'; // Change button text
         }

         // Add validation classes
         resetPasswordForm.classList.add('was-validated');
     });
</script>
